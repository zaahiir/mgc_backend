<!-- create-member-events.component.html -->
<c-row ngPreserveWhitespaces>
  <c-col xs="12">
    <c-card class="mb-4">
      <c-card-header>
        <strong>{{ isEditMode ? 'Edit Member Event' : 'New Member Event' }}</strong>
      </c-card-header>
      <c-card-body>
        <form [formGroup]="eventForm" (ngSubmit)="onSubmit()" #form="ngForm" cForm class="row g-3 needs-validation">
          
          <!-- Basic Information -->
          <c-col [cFormFloating]="true" md="6">
            <input cFormControl id="EventTitle" formControlName="EventTitle" type="text" placeholder="Event Title" />
            <label cLabel for="EventTitle" class="ms-2">Event Title *</label>
            <c-form-feedback [valid]="false" *ngIf="isFieldInvalid('EventTitle')">
              {{ getErrorMessage('EventTitle') }}
            </c-form-feedback>
          </c-col>

          <c-col [cFormFloating]="true" md="6">
            <input cFormControl id="EventDate" formControlName="EventDate" type="text" placeholder="Display Date (e.g., '22 August')" />
            <label cLabel for="EventDate" class="ms-2">Display Date *</label>
            <c-form-feedback [valid]="false" *ngIf="isFieldInvalid('EventDate')">
              {{ getErrorMessage('EventDate') }}
            </c-form-feedback>
          </c-col>

          <c-col [cFormFloating]="true" md="6">
            <input cFormControl id="EventVenue" formControlName="EventVenue" type="text" placeholder="Event Venue" />
            <label cLabel for="EventVenue" class="ms-2">Event Venue *</label>
            <c-form-feedback [valid]="false" *ngIf="isFieldInvalid('EventVenue')">
              {{ getErrorMessage('EventVenue') }}
            </c-form-feedback>
          </c-col>

          <c-col [cFormFloating]="true" md="6">
            <input cFormControl id="EventEntryPrice" formControlName="EventEntryPrice" type="text" placeholder="Event Entry Price (e.g., '$60')" />
            <label cLabel for="EventEntryPrice" class="ms-2">Event Entry Price *</label>
            <c-form-feedback [valid]="false" *ngIf="isFieldInvalid('EventEntryPrice')">
              {{ getErrorMessage('EventEntryPrice') }}
            </c-form-feedback>
          </c-col>

          <!-- Main Event Image Upload -->
          <c-col md="12">
            <label cLabel for="EventImage" class="form-label">Main Event Image *</label>
            <div class="mb-3">
              <input cFormControl id="EventImage" type="file" accept="image/*" (change)="onMainImageChange($event)" class="form-control" />
            </div>
            <div *ngIf="imagePreview" class="mb-3">
              <img [src]="imagePreview" alt="Main Image Preview" class="img-thumbnail" style="max-width: 200px; max-height: 200px;" />
              <button type="button" cButton color="danger" size="sm" class="ms-2" (click)="removeMainImage()">Remove</button>
            </div>
          </c-col>

          <!-- Event Details Section -->
          <c-col [cFormFloating]="true" md="12">
            <label cLabel for="EventDetails" class="form-label">Event Details *</label>
            <textarea cFormControl id="EventDetails" formControlName="EventDetails" placeholder="Event Details with rich text editor" rows="6"></textarea>
            <c-form-feedback [valid]="false" *ngIf="isFieldInvalid('EventDetails')">
              {{ getErrorMessage('EventDetails') }}
            </c-form-feedback>
          </c-col>

          <!-- Event Detail Images -->
          <c-col md="12">
            <label cLabel class="form-label">Event Detail Images</label>
            <div class="row">
              <c-col md="6">
                <div class="mb-3">
                  <input cFormControl id="EventDetailimageOne" type="file" accept="image/*" (change)="onAdditionalImageChange($event, 'EventDetailimageOne')" class="form-control" />
                  <div *ngIf="additionalImagePreviews['EventDetailimageOne']" class="mt-2">
                    <img [src]="additionalImagePreviews['EventDetailimageOne']" alt="Detail Image 1 Preview" class="img-thumbnail" style="max-width: 150px; max-height: 150px;" />
                    <button type="button" cButton color="danger" size="sm" class="ms-1" (click)="removeAdditionalImage('EventDetailimageOne')">Remove</button>
                  </div>
                </div>
              </c-col>
              <c-col md="6">
                <div class="mb-3">
                  <input cFormControl id="EventDetailimageTwo" type="file" accept="image/*" (change)="onAdditionalImageChange($event, 'EventDetailimageTwo')" class="form-control" />
                  <div *ngIf="additionalImagePreviews['EventDetailimageTwo']" class="mt-2">
                    <img [src]="additionalImagePreviews['EventDetailimageTwo']" alt="Detail Image 2 Preview" class="img-thumbnail" style="max-width: 150px; max-height: 150px;" />
                    <button type="button" cButton color="danger" size="sm" class="ms-1" (click)="removeAdditionalImage('EventDetailimageTwo')">Remove</button>
                  </div>
                </div>
              </c-col>
            </div>
          </c-col>

          <!-- Event Activities Section -->
          <c-col [cFormFloating]="true" md="12">
            <label cLabel for="EventActivities" class="form-label">Event Activities *</label>
            <textarea cFormControl id="EventActivities" formControlName="EventActivities" placeholder="Event Activities with rich text editor" rows="6"></textarea>
            <c-form-feedback [valid]="false" *ngIf="isFieldInvalid('EventActivities')">
              {{ getErrorMessage('EventActivities') }}
            </c-form-feedback>
          </c-col>

          <!-- Event Activities Images -->
          <c-col md="12">
            <label cLabel class="form-label">Event Activities Images</label>
            <div class="row">
              <c-col md="6">
                <div class="mb-3">
                  <input cFormControl id="EventActivitiesimageOne" type="file" accept="image/*" (change)="onAdditionalImageChange($event, 'EventActivitiesimageOne')" class="form-control" />
                  <div *ngIf="additionalImagePreviews['EventActivitiesimageOne']" class="mt-2">
                    <img [src]="additionalImagePreviews['EventActivitiesimageOne']" alt="Activities Image 1 Preview" class="img-thumbnail" style="max-width: 150px; max-height: 150px;" />
                    <button type="button" cButton color="danger" size="sm" class="ms-1" (click)="removeAdditionalImage('EventActivitiesimageOne')">Remove</button>
                  </div>
                </div>
              </c-col>
              <c-col md="6">
                <div class="mb-3">
                  <input cFormControl id="EventActivitiesimageTwo" type="file" accept="image/*" (change)="onAdditionalImageChange($event, 'EventActivitiesimageTwo')" class="form-control" />
                  <div *ngIf="additionalImagePreviews['EventActivitiesimageTwo']" class="mt-2">
                    <img [src]="additionalImagePreviews['EventActivitiesimageTwo']" alt="Activities Image 2 Preview" class="img-thumbnail" style="max-width: 150px; max-height: 150px;" />
                    <button type="button" cButton color="danger" size="sm" class="ms-1" (click)="removeAdditionalImage('EventActivitiesimageTwo')">Remove</button>
                  </div>
                </div>
              </c-col>
            </div>
          </c-col>

          <!-- Event Details -->
          <c-col [cFormFloating]="true" md="6">
            <input cFormControl id="EventDetailOrganizer" formControlName="EventDetailOrganizer" type="text" placeholder="Event Organizer" />
            <label cLabel for="EventDetailOrganizer" class="ms-2">Event Organizer *</label>
            <c-form-feedback [valid]="false" *ngIf="isFieldInvalid('EventDetailOrganizer')">
              {{ getErrorMessage('EventDetailOrganizer') }}
            </c-form-feedback>
          </c-col>

          <c-col [cFormFloating]="true" md="6">
            <input cFormControl id="EventEndDate" formControlName="EventEndDate" type="date" />
            <label cLabel for="EventEndDate" class="ms-2">Event End Date *</label>
            <c-form-feedback [valid]="false" *ngIf="isFieldInvalid('EventEndDate')">
              {{ getErrorMessage('EventEndDate') }}
            </c-form-feedback>
          </c-col>

          <c-col [cFormFloating]="true" md="6">
            <input cFormControl id="EventTime" formControlName="EventTime" type="text" placeholder="Event Time (e.g., '12:00 PM')" />
            <label cLabel for="EventTime" class="ms-2">Event Time *</label>
            <c-form-feedback [valid]="false" *ngIf="isFieldInvalid('EventTime')">
              {{ getErrorMessage('EventTime') }}
            </c-form-feedback>
          </c-col>

          <c-col [cFormFloating]="true" md="6">
            <input cFormControl id="EventEmail" formControlName="EventEmail" type="email" placeholder="Contact Email" />
            <label cLabel for="EventEmail" class="ms-2">Contact Email *</label>
            <c-form-feedback [valid]="false" *ngIf="isFieldInvalid('EventEmail')">
              {{ getErrorMessage('EventEmail') }}
            </c-form-feedback>
          </c-col>

          <c-col [cFormFloating]="true" md="6">
            <input cFormControl id="EventPhone" formControlName="EventPhone" type="text" placeholder="Contact Phone" />
            <label cLabel for="EventPhone" class="ms-2">Contact Phone *</label>
            <c-form-feedback [valid]="false" *ngIf="isFieldInvalid('EventPhone')">
              {{ getErrorMessage('EventPhone') }}
            </c-form-feedback>
          </c-col>

          <!-- Participant Button -->
          <c-col md="6">
            <div class="form-check">
              <input cFormControl id="EventParticipantButton" formControlName="EventParticipantButton" type="checkbox" class="form-check-input" />
              <label cLabel for="EventParticipantButton" class="form-check-label">
                Member is willing to participate
              </label>
            </div>
          </c-col>

          <!-- Status and Visibility -->
          <c-col md="6">
            <div class="form-check">
              <input cFormControl id="is_active" formControlName="is_active" type="checkbox" class="form-check-input" />
              <label cLabel for="is_active" class="form-check-label">
                Event is active/visible
              </label>
            </div>
          </c-col>

          <c-col md="6">
            <div class="form-check">
              <input cFormControl id="is_featured" formControlName="is_featured" type="checkbox" class="form-check-input" />
              <label cLabel for="is_featured" class="form-check-label">
                Event is featured
              </label>
            </div>
          </c-col>

          <!-- SEO and Meta -->
          <c-col [cFormFloating]="true" md="12">
            <textarea cFormControl id="meta_description" formControlName="meta_description" placeholder="SEO Meta Description (max 160 characters)" rows="3"></textarea>
            <label cLabel for="meta_description" class="ms-2">SEO Meta Description</label>
            <c-form-feedback [valid]="false" *ngIf="isFieldInvalid('meta_description')">
              {{ getErrorMessage('meta_description') }}
            </c-form-feedback>
          </c-col>

          <!-- Action Buttons -->
          <c-col xs="12" class="d-flex justify-content-between">
            <div>
              <button type="submit" cButton color="primary" [disabled]="loading">
                <span *ngIf="loading" class="spinner-border spinner-border-sm me-2"></span>
                {{ isEditMode ? 'Update Event' : 'Create Event' }}
              </button>
              <button type="button" cButton color="secondary" class="ms-2" (click)="onReset()">
                Reset
              </button>
            </div>
            <div>
              <button type="button" cButton color="info" (click)="navigateToEvents()">
                Back to Events
              </button>
              <button *ngIf="isEditMode" type="button" cButton color="danger" class="ms-2" (click)="onDelete()">
                Delete Event
              </button>
            </div>
          </c-col>
        </form>
      </c-card-body>
    </c-card>
  </c-col>
</c-row>
