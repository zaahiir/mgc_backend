<c-row ngPreserveWhitespaces>
  <c-col xs="12">
    <c-card class="mb-4">
      <c-card-header>
        <strong>Update Member Profile</strong>
      </c-card-header>
      <c-card-body>
        <form [formGroup]="memberForm"
          (ngSubmit)="onSubmit()"
          cForm
          class="row g-3 needs-validation"
        >
          <!-- Basic Information -->
          <c-col [cFormFloating]="true" md="6">
            <input cFormControl id="firstName" formControlName="firstName" required type="text" placeholder="First Name" />
            <label cLabel for="firstName" class="ms-2">First Name</label>
            <c-form-feedback [valid]="false" *ngIf="isFieldInvalid('firstName')">
              {{ getErrorMessage('firstName') }}
            </c-form-feedback>
          </c-col>

          <c-col [cFormFloating]="true" md="6">
            <input cFormControl id="lastName" formControlName="lastName" required type="text" placeholder="Last Name" />
            <label cLabel for="lastName" class="ms-2">Last Name</label>
            <c-form-feedback [valid]="false" *ngIf="isFieldInvalid('lastName')">
              {{ getErrorMessage('lastName') }}
            </c-form-feedback>
          </c-col>

          <c-col [cFormFloating]="true" md="6">
            <input cFormControl id="email" formControlName="email" required type="email" placeholder="Email" />
            <label cLabel for="email" class="ms-2">Email</label>
            <c-form-feedback [valid]="false" *ngIf="isFieldInvalid('email')">
              {{ getErrorMessage('email') }}
            </c-form-feedback>
          </c-col>

          <c-col [cFormFloating]="true" md="6">
            <input cFormControl id="phoneNumber" formControlName="phoneNumber" required type="tel" placeholder="Phone Number" />
            <label cLabel for="phoneNumber" class="ms-2">Phone Number</label>
            <c-form-feedback [valid]="false" *ngIf="isFieldInvalid('phoneNumber')">
              {{ getErrorMessage('phoneNumber') }}
            </c-form-feedback>
          </c-col>

          <c-col [cFormFloating]="true" md="6">
            <input cFormControl id="alternatePhoneNumber" formControlName="alternatePhoneNumber" type="tel" placeholder="Alternate Phone Number" />
            <label cLabel for="alternatePhoneNumber" class="ms-2">Alternate Phone Number</label>
          </c-col>

          <c-col [cFormFloating]="true" md="6">
            <input cFormControl id="dateOfBirth" formControlName="dateOfBirth" type="date" placeholder="Date of Birth" />
            <label cLabel for="dateOfBirth" class="ms-2">Date of Birth</label>
          </c-col>

          <c-col [cFormFloating]="true" md="6">
            <select cSelect id="gender" formControlName="gender">
              <option value="">Select Gender</option>
              <option *ngFor="let gender of genders" [value]="gender.id">
                {{ gender.genderName }}
              </option>
            </select>
            <label cLabel for="gender" class="ms-2">Gender</label>
          </c-col>

          <c-col [cFormFloating]="true" md="6">
            <select cSelect id="nationality" formControlName="nationality">
              <option value="">Select Nationality</option>
              <option *ngFor="let nationality of nationalities" [value]="nationality.id">
                {{ nationality.countryName }}
              </option>
            </select>
            <label cLabel for="nationality" class="ms-2">Nationality</label>
          </c-col>

          <c-col [cFormFloating]="true" md="12">
            <textarea cFormControl id="address" formControlName="address" placeholder="Address" rows="3"></textarea>
            <label cLabel for="address" class="ms-2">Address</label>
          </c-col>

          <c-col [cFormFloating]="true" md="6">
            <select cSelect id="plan" formControlName="plan" required>
              <option value="">Select Plan</option>
              <option *ngFor="let plan of plans" [value]="plan.id">
                {{ plan.planName }}
              </option>
            </select>
            <label cLabel for="plan" class="ms-2">Membership Plan</label>
            <c-form-feedback [valid]="false" *ngIf="isFieldInvalid('plan')">
              {{ getErrorMessage('plan') }}
            </c-form-feedback>
          </c-col>

          <c-col [cFormFloating]="true" md="6">
            <input cFormControl id="golfClubId" formControlName="golfClubId" readonly type="text" placeholder="Golf Club ID" />
            <label cLabel for="golfClubId" class="ms-2">Golf Club ID</label>
          </c-col>

          <c-col [cFormFloating]="true" md="6">
            <input cFormControl id="membershipStartDate" formControlName="membershipStartDate" type="date"
                   placeholder="Membership Start Date" />
            <label cLabel for="membershipStartDate" class="ms-2">Membership Start Date</label>
          </c-col>

          <c-col [cFormFloating]="true" md="6">
            <input cFormControl id="membershipEndDate" formControlName="membershipEndDate" type="date"
                   placeholder="Membership End Date" />
            <label cLabel for="membershipEndDate" class="ms-2">Membership End Date</label>
          </c-col>

          <!-- Payment Information -->
          <c-col [cFormFloating]="true" md="6">
            <select cSelect id="paymentStatus" formControlName="paymentStatus">
              <option value="">Select Payment Status</option>
              <option *ngFor="let status of paymentStatuses" [value]="status.id">
                {{ status.statusName }}
              </option>
            </select>
            <label cLabel for="paymentStatus" class="ms-2">Payment Status</label>
          </c-col>

          <c-col [cFormFloating]="true" md="6">
            <select cSelect id="paymentMethod" formControlName="paymentMethod">
              <option value="">Select Payment Method</option>
              <option *ngFor="let method of paymentMethods" [value]="method.id">
                {{ method.methodName }}
              </option>
            </select>
            <label cLabel for="paymentMethod" class="ms-2">Payment Method</label>
          </c-col>

          <!-- Emergency Contact -->
          <c-col [cFormFloating]="true" md="6">
            <input cFormControl id="emergencyContactName" formControlName="emergencyContactName" type="text"
                   placeholder="Emergency Contact Name" />
            <label cLabel for="emergencyContactName" class="ms-2">Emergency Contact Name</label>
          </c-col>

          <c-col [cFormFloating]="true" md="6">
            <input cFormControl id="emergencyContactPhone" formControlName="emergencyContactPhone" type="tel"
                   placeholder="Emergency Contact Phone" />
            <label cLabel for="emergencyContactPhone" class="ms-2">Emergency Contact Phone</label>
          </c-col>

          <c-col [cFormFloating]="true" md="6">
            <input cFormControl id="emergencyContactRelation" formControlName="emergencyContactRelation" type="text"
                   placeholder="Relationship" />
            <label cLabel for="emergencyContactRelation" class="ms-2">Relationship</label>
          </c-col>

          <c-col [cFormFloating]="true" md="6">
            <input cFormControl id="referredBy" formControlName="referredBy" type="text"
                   placeholder="Referred By" />
            <label cLabel for="referredBy" class="ms-2">Referred By (Optional)</label>
          </c-col>

          <!-- File Uploads -->
          <c-col md="6">
            <div class="mb-3">
              <label cLabel for="profilePhoto" class="form-label">Profile Photo</label>
              <input cFormControl class="form-control" type="file" id="profilePhoto"
                     accept="image/*" (change)="onFileSelected($event, 'profile')" />
              <div *ngIf="profilePhotoPreview" class="mt-2">
                <img [src]="profilePhotoPreview" alt="Profile Preview"
                     style="max-width: 200px; max-height: 200px;" class="img-thumbnail" />
                <button cButton color="danger" size="sm" class="ms-2" type="button"
                        (click)="removeFile('profile')">
                  Remove Photo
                </button>
              </div>
            </div>
          </c-col>

          <c-col md="6">
            <div class="mb-3">
              <label cLabel for="idProof" class="form-label">ID Proof</label>
              <input cFormControl class="form-control" type="file" id="idProof"
                     accept=".pdf,.jpg,.jpeg,.png" (change)="onFileSelected($event, 'idProof')" />
              <div *ngIf="idProofPreview" class="mt-2">
                <ng-container *ngIf="idProofPreview.toString().includes('data:image')">
                  <img [src]="idProofPreview" alt="ID Proof Preview"
                       style="max-width: 200px; max-height: 200px;" class="img-thumbnail" />
                </ng-container>
                <ng-container *ngIf="!idProofPreview.toString().includes('data:image')">
                  <div class="alert alert-info">
                    ID Proof document uploaded
                  </div>
                </ng-container>
                <button cButton color="danger" size="sm" class="ms-2" type="button"
                        (click)="removeFile('idProof')">
                  Remove ID Proof
                </button>
              </div>
            </div>
          </c-col>

          <!-- Additional Information -->
          <c-col md="6">
            <div class="form-check mt-3">
              <input class="form-check-input" type="checkbox" id="handicap"
                     formControlName="handicap" />
              <label class="form-check-label" for="handicap">
                Handicap
              </label>
            </div>
          </c-col>

          <!-- Form Actions -->
          <c-col xs="12" class="mt-4">
            <button cButton class="me-2" color="primary" type="submit" [disabled]="loading">
              {{ loading ? 'Saving...' : 'Update Member Profile' }}
            </button>
            <button cButton color="secondary" type="button" [disabled]="loading"
                    (click)="onCancel()">
              Cancel
            </button>
          </c-col>
        </form>
      </c-card-body>
    </c-card>
  </c-col>
</c-row>
